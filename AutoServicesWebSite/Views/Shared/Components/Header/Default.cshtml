@model AutoServicesWebSite.Models.Header

@{
    Layout = null;
}
@if (Model.IsMechanic)
{
    <script src="/lib/jquery/dist/jquery.js"></script>
    <script type="text/javascript">
        var GetCountUrl = '/Queue/QueueCount';
        $(function () {
            GetCount();
        });
        function GetCount() {
            $.ajax({
                type: "GET",
                url: GetCountUrl,
                success: function (queueCount) {
                    var value = queueCount;
                    $('.queue-count').html(value);
                    if (value === 0) {
                        $('ul li .disabled').show();
                    }
                    else {
                        $('ul li .disabled').hide();
                    }
                    setTimeout(GetCount, 10000);
                },
                error: function (error) {
                    console.log(error);
                }
            });
        }
    </script>

}


<style>
    .queue-count {
        border-radius: 20px;
        color: #fff;
        background: #ff0000;
        position: absolute;
        top: 0;
        right: 0;
        font-size: 11px;
        display: block;
        width: 20px;
        height: 20px;
        text-align: center;
        margin-right: -5px;
        z-index: 1;
    }

    .disabled {
        width: 100%;
        height: 100%;
        position: absolute;
        display: none;
    }
</style>

<ul class="nav navbar-nav">
    @if (Model.IsMechanic)
    {
        <li>
            <a class="new-protocol" asp-area="" asp-controller="Protocol" asp-action="add">нов протокол<span class="queue-count">0</span></a>
            <div class="disabled"></div>
        </li>
        @if (Model.IncomleteQueueId.HasValue)
        {
            <li>
                <a class="new-protocol incomplete" asp-area="" asp-controller="Protocol" asp-action="Add" asp-route-id="@Model.IncomleteQueueId.Value">незавършен протокол</a>
            </li>
        }
    }
    @if (Model.IsTechnician || Model.IsOffice)
    {
        <li><a asp-area="" asp-controller="Protocol" asp-action="history">история</a></li>
        if (Model.IsTechnician)
        {
            <li><a asp-area="" asp-controller="Place" asp-action="Edit">места</a></li>
        }
        <li><a asp-area="" asp-controller="Protocol" asp-action="addexternal">нов протокол</a></li>
    }
    @if (Model.IsAdministrator)
    {
        <li><a asp-area="" asp-controller="User" asp-action="All">потребители</a></li>
        <li><a asp-area="" asp-controller="Place" asp-action="Edit">места</a></li>
        <li><a asp-area="" asp-controller="Setting" asp-action="Edit">настройки апликация</a></li>
        <li><a href="#" id="open-popup">изчисти опашка</a></li>
    }
    <li><a asp-area="" asp-controller="User" asp-action="LogOut">изход</a></li>
</ul>
